<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/alpacanotes/_next/static/css/87ceaea6f9666f43.css" data-precedence="next"/><link rel="stylesheet" href="/alpacanotes/_next/static/css/b147b4b724ae21ef.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/alpacanotes/_next/static/chunks/webpack-1ed120f40a346afc.js"/><script src="/alpacanotes/_next/static/chunks/4bd1b696-018d5d15d5e61bde.js" async=""></script><script src="/alpacanotes/_next/static/chunks/517-4eb3cab2fd928649.js" async=""></script><script src="/alpacanotes/_next/static/chunks/main-app-498d8712a9aaaeae.js" async=""></script><script src="/alpacanotes/_next/static/chunks/app/layout-50006a05f4f38e04.js" async=""></script><script src="/alpacanotes/_next/static/chunks/935-c3c4a42486495e3b.js" async=""></script><script src="/alpacanotes/_next/static/chunks/30-cde6a761eaef6c52.js" async=""></script><script src="/alpacanotes/_next/static/chunks/598-8424641e72451bd5.js" async=""></script><script src="/alpacanotes/_next/static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-99PGBGJH4S" as="script"/><title>AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes</title><meta name="description" content="本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。"/><meta property="og:title" content="AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes"/><meta property="og:description" content="本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。"/><meta property="og:url" content="https://linguista.cn/alpacanotes/articles/telegram-integration-v3"/><meta property="og:image" content="https://linguista.cn/alpacanotes/aztecaalpaca.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2026-01-24"/><meta property="article:author" content="@linguista2025"/><meta property="article:tag" content="DevOps"/><meta property="article:tag" content="Telegram"/><meta property="article:tag" content="GitHub Actions"/><meta property="article:tag" content="Automation"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes"/><meta name="twitter:description" content="本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。"/><meta name="twitter:image" content="https://linguista.cn/alpacanotes/aztecaalpaca.jpg"/><link rel="icon" href="/alpacanotes/favicon.svg" type="image/svg+xml"/><script src="/alpacanotes/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased min-h-screen"><script>((e,t,r,n,o,a,i,u)=>{let s=document.documentElement,l=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&a?o.map(e=>a[e]||e):o;r?(s.classList.remove(...n),s.classList.add(a&&a[t]?a[t]:t)):s.setAttribute(e,t)}),u&&l.includes(t)&&(s.style.colorScheme=t)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><main class="min-h-screen pb-20"><header class="py-8 mb-12"><div class="max-w-6xl mx-auto px-6 flex justify-between items-center relative z-50"><a class="text-accent font-extrabold text-2xl tracking-tight hover:opacity-80 transition-opacity" href="/alpacanotes">AlpacaNotes</a><nav class="hidden md:flex items-center gap-8 text-base font-semibold text-muted"><a class="hover:text-foreground transition-colors" href="/alpacanotes/articles">Articles</a><a class="hover:text-foreground transition-colors" href="/alpacanotes/notes">Notes</a><a class="hover:text-foreground transition-colors" href="/alpacanotes/tweets">Tweets</a><a class="hover:text-foreground transition-colors" href="/alpacanotes/topics">Topics</a><a class="hover:text-foreground transition-colors" href="/alpacanotes/prompts">Prompts</a><a class="hover:text-foreground transition-colors" href="/alpacanotes/rss.xml">RSS</a><div class="pl-6 border-l border-border-subtle flex items-center"><button class="p-2 transition-opacity hover:opacity-80" aria-label="Toggle theme"><div class="w-6 h-6 rounded-full border border-[var(--accent)]" style="background:linear-gradient(90deg, var(--accent) 50%, #ffffff 50%)"></div><span class="sr-only">Toggle theme</span></button></div></nav><div class="md:hidden flex items-center gap-4"><button class="p-2 transition-opacity hover:opacity-80" aria-label="Toggle theme"><div class="w-6 h-6 rounded-full border border-[var(--accent)]" style="background:linear-gradient(90deg, var(--accent) 50%, #ffffff 50%)"></div><span class="sr-only">Toggle theme</span></button><button class="text-muted hover:text-foreground transition-colors p-2 -mr-2" aria-label="Toggle menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></header><article class="container-custom relative md-theme-amp-outer"><header class="mb-10"><h1 class="text-3xl md:text-4xl font-bold mb-4 text-center font-serif text-[#3e3832] dark:text-[#f0f6fc]">AlpacaNotes博客 集成 Telegram 自动推送实战</h1><div class="text-sm text-muted">2026-01-24</div></header><div class="prose md-theme-amp"><p>为了方便读者及时获取更新，我为 AlpacaNotes 博客增加了 Telegram 频道自动推送功能。每当有新文章发布时，GitHub Actions 会自动触发脚本，将文章标题和链接发送到订阅频道。以下是实现这一功能的简要流程。</p>
<h2 id="1-申请-telegram-bot">1. 申请 Telegram Bot</h2>
<p>首先，你需要拥有一个 Telegram 账号并申请一个机器人：</p>
<ol>
<li>在 Telegram 中搜索 <strong>@BotFather</strong>。</li>
<li>发送指令 <code>/newbot</code> 创建新机器人。</li>
<li>按照提示设置机器人的名称（Name）和用户名（Username）。</li>
<li>创建成功后，BotFather 会给你一个 <strong>HTTP API Token</strong>（类似 <code>123456789:ABCdef...</code>），请妥善保管。</li>
</ol>
<h2 id="2-设置频道并获取-chat-id">2. 设置频道并获取 Chat ID</h2>
<ol>
<li>创建一个新的 Telegram Channel（频道），或者使用现有频道。</li>
<li>将你刚才创建的机器人添加为频道管理员（Administrator），赋予发送消息的权限。</li>
<li>为了获取频道的 <code>Chat ID</code>，你可以先在频道里随便发一条消息，然后转发给 <strong>@getidsbot</strong>（或其他类似 ID 查询机器人），它会返回以 <code>-100</code> 开头的频道 ID（例如 <code>-1003229698152</code>）。</li>
</ol>
<h2 id="3-配置-github-secrets">3. 配置 GitHub Secrets</h2>
<p>为了安全起见，不要将 Token 直接硬编码在代码中。</p>
<ol>
<li>进入博客项目的 GitHub 仓库页面。</li>
<li>点击 <strong>Settings</strong> -> <strong>Secrets and variables</strong> -> <strong>Actions</strong>。</li>
<li>新建 Repository Secret：
<ul>
<li><code>TELEGRAM_TOKEN</code>: 填入 BotFather 给你的 Token。</li>
</ul>
</li>
</ol>
<h2 id="4-编写自动化脚本">4. 编写自动化脚本</h2>
<p>在项目中编写一个 Node.js 脚本（<code>scripts/telegram-notify.js</code>），用于检测变更并发送消息。</p>
<p>主要逻辑如下：</p>
<ol>
<li>使用 <code>git diff</code> 识别本次提交中<strong>新增</strong>的 <code>.md</code> 文件。</li>
<li>解析 Markdown 文件的 Frontmatter（元数据），提取标题和描述。</li>
<li>调用 Telegram 的 <code>sendMessage</code> API，将文章标题、描述和链接格式化后发送到指定频道。</li>
</ol>
<h2 id="5-配置-github-actions-工作流">5. 配置 GitHub Actions 工作流</h2>
<p>最后，修改 <code>.github/workflows/deploy.yml</code> 文件，在部署流程中加入通知步骤：</p>
<pre><code class="language-yaml">- name: Check for new content and notify
  if: success()
  env:
    TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
    TELEGRAM_TO: "-1003229698152" # 你的频道 ID
    SITE_URL: "https://linguista.cn"
    BASE_PATH: "/alpacanotes"
  run: node scripts/telegram-notify.js
</code></pre>
<h2 id="6-静态站点部署配置">6. 静态站点部署配置</h2>
<p>本博客使用 Next.js 构建，并托管在 GitHub Pages 上。为了确保静态资源加载正确（特别是当部署在子路径如 <code>/alpacanotes</code> 下时），需要在 <code>next.config.ts</code> 中进行特别配置：</p>
<pre><code class="language-typescript">const isProd = process.env.NODE_ENV === "production";

const nextConfig: NextConfig = {
  // 启用静态导出模式，生成纯 HTML/CSS/JS 文件
  output: isProd ? "export" : undefined,
  
  // 禁用 Next.js 自带的图片优化服务（GitHub Pages 不支持 Node.js 运行时）
  images: {
    unoptimized: true,
  },
  
  // 设置子路径，匹配 GitHub Pages 的仓库名
  basePath: isProd ? "/alpacanotes" : "",
  assetPrefix: isProd ? "/alpacanotes/" : "",
};
</code></pre>
<p>此外，部署工作流使用了 <code>peaceiris/actions-gh-pages</code> Action，它会将 <code>out</code> 目录（Next.js <code>output: 'export'</code> 的产物）自动发布到 <code>gh-pages</code> 分支。</p>
<h2 id="7-配置-telegram-instant-view-即时预览">7. 配置 Telegram Instant View (即时预览)</h2>
<p>为了让用户在 Telegram 中获得更好的阅读体验（无需跳转浏览器即可秒开文章），我们配置了 Instant View。</p>
<h3 id="71-创建-instant-view-模板">7.1 创建 Instant View 模板</h3>
<ol>
<li>登录 <a href="https://instantview.telegram.org/my/">Telegram Instant View Editor</a>。</li>
<li>输入你的博客文章示例链接（例如 <code>https://linguista.cn/alpacanotes/articles/telegram-integration</code>）。</li>
<li>编写提取规则。本项目使用的规则如下（已保存为 <code>instant-view-rules.txt</code>）：</li>
</ol>
<pre><code class="language-yaml">~version: "2.1"

# 1. Content Body
body: //article

# 2. Title
title: //h1

# 3. Subtitle (Articles only)
subtitle: //article//header//p[contains(@class, "text-xl")]

# 4. Published Date (Articles: Header / Notes: Footer)
published_date: //header//div[contains(@class, "text-sm")] | //div[contains(@class, "mt-4") and contains(@class, "text-sm")]

# 5. Cleanup
# Fix: &#x3C;img> inside &#x3C;p> is not allowed
@split_parent: //p/img
@remove: //div[contains(@class, "mt-16")]/a[contains(@href, "/articles")]/..
</code></pre>
<ol start="4">
<li>点击 <strong>Mark as Published</strong>，你将获得一个 <strong>rhash</strong>（一串哈希值，例如 <code>d41d8cd98f00b204e980</code>）。</li>
</ol>
<h3 id="72-配置-github-secrets">7.2 配置 GitHub Secrets</h3>
<ol>
<li>回到 GitHub 仓库的 <strong>Settings</strong> > <strong>Secrets and variables</strong> > <strong>Actions</strong>。</li>
<li>新建 Secret <code>TELEGRAM_IV_RHASH</code>，填入刚才获得的 hash 值。</li>
</ol>
<h3 id="73-脚本支持">7.3 脚本支持</h3>
<p>我们采用了 Telegram Bot API 新版功能 <code>link_preview_options</code> 来完美解决兼容性问题：</p>
<ol>
<li><strong>显式指定预览链接</strong>：我们在 API 调用中明确告诉 Telegram 使用 Instant View 链接 (<code>t.me/iv?...</code>) 来生成预览卡片。</li>
<li><strong>保留正文原始链接</strong>：消息正文中的 <code>[Read More]</code> 保持指向博客原始网址。</li>
</ol>
<p><strong>效果</strong>：</p>
<ul>
<li><strong>App 端</strong>：用户看到的是带有 Instant View 按钮的卡片，点击即开。</li>
<li><strong>Web 端</strong>：预览卡片可能不显示或显示为普通链接，但用户点击正文链接时，会直接跳转博客原站，不会出现无法打开的情况。</li>
</ul>
<hr>
<p><em>本文即为该功能的测试文章。如果你在 Telegram 频道看到了这条推送，说明自动化流程已配置成功！</em></p></div><div class="mt-16 pt-8 border-t border-[var(--border-subtle)]"><a class="text-accent hover:text-foreground transition-colors" href="/alpacanotes/articles">← Back to Articles</a></div></article></main><script src="/alpacanotes/_next/static/chunks/webpack-1ed120f40a346afc.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"3:\"$Sreact.fragment\"\n4:I[6498,[\"177\",\"static/chunks/app/layout-50006a05f4f38e04.js\"],\"default\"]\n5:I[8312,[\"177\",\"static/chunks/app/layout-50006a05f4f38e04.js\"],\"ThemeProvider\"]\n6:I[5244,[],\"\"]\n7:I[3866,[],\"\"]\n9:I[6213,[],\"OutletBoundary\"]\nb:I[6213,[],\"MetadataBoundary\"]\nd:I[6213,[],\"ViewportBoundary\"]\nf:I[4835,[],\"\"]\n1:HL[\"/alpacanotes/_next/static/css/87ceaea6f9666f43.css\",\"style\"]\n2:HL[\"/alpacanotes/_next/static/css/b147b4b724ae21ef.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"wnF62RkLyUnk4XA3X-CfP\",\"p\":\"/alpacanotes\",\"c\":[\"\",\"articles\",\"telegram-integration-v3\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"articles\",{\"children\":[[\"id\",\"telegram-integration-v3\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$3\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/alpacanotes/_next/static/css/87ceaea6f9666f43.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/alpacanotes/_next/static/css/b147b4b724ae21ef.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased min-h-screen\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}]]}]}]]}],{\"children\":[\"articles\",[\"$\",\"$3\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"articles\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"telegram-integration-v3\",\"d\"],[\"$\",\"$3\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"articles\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$3\",\"c\",{\"children\":[\"$L8\",null,[\"$\",\"$L9\",null,{\"children\":\"$La\"}]]}],{},null]},null]},null]},null],[\"$\",\"$3\",\"h\",{\"children\":[null,[\"$\",\"$3\",\"z78Mw98w7pbqpnvhoSNhq\",{\"children\":[[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],null]}]]}]]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:I[2647,[\"935\",\"static/chunks/935-c3c4a42486495e3b.js\",\"30\",\"static/chunks/30-cde6a761eaef6c52.js\",\"598\",\"static/chunks/598-8424641e72451bd5.js\",\"406\",\"static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js\"],\"default\"]\n11:I[7123,[\"935\",\"static/chunks/935-c3c4a42486495e3b.js\",\"30\",\"static/chunks/30-cde6a761eaef6c52.js\",\"598\",\"static/chunks/598-8424641e72451bd5.js\",\"406\",\"static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js\"],\"default\"]\n14:I[4839,[\"935\",\"static/chunks/935-c3c4a42486495e3b.js\",\"30\",\"static/chunks/30-cde6a761eaef6c52.js\",\"598\",\"static/chunks/598-8424641e72451bd5.js\",\"406\",\"static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js\"],\"\"]\n12:T1a0f,"])</script><script>self.__next_f.push([1,"\u003cp\u003e为了方便读者及时获取更新，我为 AlpacaNotes 博客增加了 Telegram 频道自动推送功能。每当有新文章发布时，GitHub Actions 会自动触发脚本，将文章标题和链接发送到订阅频道。以下是实现这一功能的简要流程。\u003c/p\u003e\n\u003ch2 id=\"1-申请-telegram-bot\"\u003e1. 申请 Telegram Bot\u003c/h2\u003e\n\u003cp\u003e首先，你需要拥有一个 Telegram 账号并申请一个机器人：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e在 Telegram 中搜索 \u003cstrong\u003e@BotFather\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e发送指令 \u003ccode\u003e/newbot\u003c/code\u003e 创建新机器人。\u003c/li\u003e\n\u003cli\u003e按照提示设置机器人的名称（Name）和用户名（Username）。\u003c/li\u003e\n\u003cli\u003e创建成功后，BotFather 会给你一个 \u003cstrong\u003eHTTP API Token\u003c/strong\u003e（类似 \u003ccode\u003e123456789:ABCdef...\u003c/code\u003e），请妥善保管。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"2-设置频道并获取-chat-id\"\u003e2. 设置频道并获取 Chat ID\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e创建一个新的 Telegram Channel（频道），或者使用现有频道。\u003c/li\u003e\n\u003cli\u003e将你刚才创建的机器人添加为频道管理员（Administrator），赋予发送消息的权限。\u003c/li\u003e\n\u003cli\u003e为了获取频道的 \u003ccode\u003eChat ID\u003c/code\u003e，你可以先在频道里随便发一条消息，然后转发给 \u003cstrong\u003e@getidsbot\u003c/strong\u003e（或其他类似 ID 查询机器人），它会返回以 \u003ccode\u003e-100\u003c/code\u003e 开头的频道 ID（例如 \u003ccode\u003e-1003229698152\u003c/code\u003e）。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"3-配置-github-secrets\"\u003e3. 配置 GitHub Secrets\u003c/h2\u003e\n\u003cp\u003e为了安全起见，不要将 Token 直接硬编码在代码中。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e进入博客项目的 GitHub 仓库页面。\u003c/li\u003e\n\u003cli\u003e点击 \u003cstrong\u003eSettings\u003c/strong\u003e -\u003e \u003cstrong\u003eSecrets and variables\u003c/strong\u003e -\u003e \u003cstrong\u003eActions\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e新建 Repository Secret：\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eTELEGRAM_TOKEN\u003c/code\u003e: 填入 BotFather 给你的 Token。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"4-编写自动化脚本\"\u003e4. 编写自动化脚本\u003c/h2\u003e\n\u003cp\u003e在项目中编写一个 Node.js 脚本（\u003ccode\u003escripts/telegram-notify.js\u003c/code\u003e），用于检测变更并发送消息。\u003c/p\u003e\n\u003cp\u003e主要逻辑如下：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e使用 \u003ccode\u003egit diff\u003c/code\u003e 识别本次提交中\u003cstrong\u003e新增\u003c/strong\u003e的 \u003ccode\u003e.md\u003c/code\u003e 文件。\u003c/li\u003e\n\u003cli\u003e解析 Markdown 文件的 Frontmatter（元数据），提取标题和描述。\u003c/li\u003e\n\u003cli\u003e调用 Telegram 的 \u003ccode\u003esendMessage\u003c/code\u003e API，将文章标题、描述和链接格式化后发送到指定频道。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"5-配置-github-actions-工作流\"\u003e5. 配置 GitHub Actions 工作流\u003c/h2\u003e\n\u003cp\u003e最后，修改 \u003ccode\u003e.github/workflows/deploy.yml\u003c/code\u003e 文件，在部署流程中加入通知步骤：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-yaml\"\u003e- name: Check for new content and notify\n  if: success()\n  env:\n    TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}\n    TELEGRAM_TO: \"-1003229698152\" # 你的频道 ID\n    SITE_URL: \"https://linguista.cn\"\n    BASE_PATH: \"/alpacanotes\"\n  run: node scripts/telegram-notify.js\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"6-静态站点部署配置\"\u003e6. 静态站点部署配置\u003c/h2\u003e\n\u003cp\u003e本博客使用 Next.js 构建，并托管在 GitHub Pages 上。为了确保静态资源加载正确（特别是当部署在子路径如 \u003ccode\u003e/alpacanotes\u003c/code\u003e 下时），需要在 \u003ccode\u003enext.config.ts\u003c/code\u003e 中进行特别配置：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003econst isProd = process.env.NODE_ENV === \"production\";\n\nconst nextConfig: NextConfig = {\n  // 启用静态导出模式，生成纯 HTML/CSS/JS 文件\n  output: isProd ? \"export\" : undefined,\n  \n  // 禁用 Next.js 自带的图片优化服务（GitHub Pages 不支持 Node.js 运行时）\n  images: {\n    unoptimized: true,\n  },\n  \n  // 设置子路径，匹配 GitHub Pages 的仓库名\n  basePath: isProd ? \"/alpacanotes\" : \"\",\n  assetPrefix: isProd ? \"/alpacanotes/\" : \"\",\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e此外，部署工作流使用了 \u003ccode\u003epeaceiris/actions-gh-pages\u003c/code\u003e Action，它会将 \u003ccode\u003eout\u003c/code\u003e 目录（Next.js \u003ccode\u003eoutput: 'export'\u003c/code\u003e 的产物）自动发布到 \u003ccode\u003egh-pages\u003c/code\u003e 分支。\u003c/p\u003e\n\u003ch2 id=\"7-配置-telegram-instant-view-即时预览\"\u003e7. 配置 Telegram Instant View (即时预览)\u003c/h2\u003e\n\u003cp\u003e为了让用户在 Telegram 中获得更好的阅读体验（无需跳转浏览器即可秒开文章），我们配置了 Instant View。\u003c/p\u003e\n\u003ch3 id=\"71-创建-instant-view-模板\"\u003e7.1 创建 Instant View 模板\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e登录 \u003ca href=\"https://instantview.telegram.org/my/\"\u003eTelegram Instant View Editor\u003c/a\u003e。\u003c/li\u003e\n\u003cli\u003e输入你的博客文章示例链接（例如 \u003ccode\u003ehttps://linguista.cn/alpacanotes/articles/telegram-integration\u003c/code\u003e）。\u003c/li\u003e\n\u003cli\u003e编写提取规则。本项目使用的规则如下（已保存为 \u003ccode\u003einstant-view-rules.txt\u003c/code\u003e）：\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-yaml\"\u003e~version: \"2.1\"\n\n# 1. Content Body\nbody: //article\n\n# 2. Title\ntitle: //h1\n\n# 3. Subtitle (Articles only)\nsubtitle: //article//header//p[contains(@class, \"text-xl\")]\n\n# 4. Published Date (Articles: Header / Notes: Footer)\npublished_date: //header//div[contains(@class, \"text-sm\")] | //div[contains(@class, \"mt-4\") and contains(@class, \"text-sm\")]\n\n# 5. Cleanup\n# Fix: \u0026#x3C;img\u003e inside \u0026#x3C;p\u003e is not allowed\n@split_parent: //p/img\n@remove: //div[contains(@class, \"mt-16\")]/a[contains(@href, \"/articles\")]/..\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e点击 \u003cstrong\u003eMark as Published\u003c/strong\u003e，你将获得一个 \u003cstrong\u003erhash\u003c/strong\u003e（一串哈希值，例如 \u003ccode\u003ed41d8cd98f00b204e980\u003c/code\u003e）。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"72-配置-github-secrets\"\u003e7.2 配置 GitHub Secrets\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e回到 GitHub 仓库的 \u003cstrong\u003eSettings\u003c/strong\u003e \u003e \u003cstrong\u003eSecrets and variables\u003c/strong\u003e \u003e \u003cstrong\u003eActions\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e新建 Secret \u003ccode\u003eTELEGRAM_IV_RHASH\u003c/code\u003e，填入刚才获得的 hash 值。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"73-脚本支持\"\u003e7.3 脚本支持\u003c/h3\u003e\n\u003cp\u003e我们采用了 Telegram Bot API 新版功能 \u003ccode\u003elink_preview_options\u003c/code\u003e 来完美解决兼容性问题：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e显式指定预览链接\u003c/strong\u003e：我们在 API 调用中明确告诉 Telegram 使用 Instant View 链接 (\u003ccode\u003et.me/iv?...\u003c/code\u003e) 来生成预览卡片。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e保留正文原始链接\u003c/strong\u003e：消息正文中的 \u003ccode\u003e[Read More]\u003c/code\u003e 保持指向博客原始网址。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003e效果\u003c/strong\u003e：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eApp 端\u003c/strong\u003e：用户看到的是带有 Instant View 按钮的卡片，点击即开。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWeb 端\u003c/strong\u003e：预览卡片可能不显示或显示为普通链接，但用户点击正文链接时，会直接跳转博客原站，不会出现无法打开的情况。\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003e本文即为该功能的测试文章。如果你在 Telegram 频道看到了这条推送，说明自动化流程已配置成功！\u003c/em\u003e\u003c/p\u003e"])</script><script>self.__next_f.push([1,"13:T1a0f,"])</script><script>self.__next_f.push([1,"\u003cp\u003e为了方便读者及时获取更新，我为 AlpacaNotes 博客增加了 Telegram 频道自动推送功能。每当有新文章发布时，GitHub Actions 会自动触发脚本，将文章标题和链接发送到订阅频道。以下是实现这一功能的简要流程。\u003c/p\u003e\n\u003ch2 id=\"1-申请-telegram-bot\"\u003e1. 申请 Telegram Bot\u003c/h2\u003e\n\u003cp\u003e首先，你需要拥有一个 Telegram 账号并申请一个机器人：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e在 Telegram 中搜索 \u003cstrong\u003e@BotFather\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e发送指令 \u003ccode\u003e/newbot\u003c/code\u003e 创建新机器人。\u003c/li\u003e\n\u003cli\u003e按照提示设置机器人的名称（Name）和用户名（Username）。\u003c/li\u003e\n\u003cli\u003e创建成功后，BotFather 会给你一个 \u003cstrong\u003eHTTP API Token\u003c/strong\u003e（类似 \u003ccode\u003e123456789:ABCdef...\u003c/code\u003e），请妥善保管。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"2-设置频道并获取-chat-id\"\u003e2. 设置频道并获取 Chat ID\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e创建一个新的 Telegram Channel（频道），或者使用现有频道。\u003c/li\u003e\n\u003cli\u003e将你刚才创建的机器人添加为频道管理员（Administrator），赋予发送消息的权限。\u003c/li\u003e\n\u003cli\u003e为了获取频道的 \u003ccode\u003eChat ID\u003c/code\u003e，你可以先在频道里随便发一条消息，然后转发给 \u003cstrong\u003e@getidsbot\u003c/strong\u003e（或其他类似 ID 查询机器人），它会返回以 \u003ccode\u003e-100\u003c/code\u003e 开头的频道 ID（例如 \u003ccode\u003e-1003229698152\u003c/code\u003e）。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"3-配置-github-secrets\"\u003e3. 配置 GitHub Secrets\u003c/h2\u003e\n\u003cp\u003e为了安全起见，不要将 Token 直接硬编码在代码中。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e进入博客项目的 GitHub 仓库页面。\u003c/li\u003e\n\u003cli\u003e点击 \u003cstrong\u003eSettings\u003c/strong\u003e -\u003e \u003cstrong\u003eSecrets and variables\u003c/strong\u003e -\u003e \u003cstrong\u003eActions\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e新建 Repository Secret：\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eTELEGRAM_TOKEN\u003c/code\u003e: 填入 BotFather 给你的 Token。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"4-编写自动化脚本\"\u003e4. 编写自动化脚本\u003c/h2\u003e\n\u003cp\u003e在项目中编写一个 Node.js 脚本（\u003ccode\u003escripts/telegram-notify.js\u003c/code\u003e），用于检测变更并发送消息。\u003c/p\u003e\n\u003cp\u003e主要逻辑如下：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e使用 \u003ccode\u003egit diff\u003c/code\u003e 识别本次提交中\u003cstrong\u003e新增\u003c/strong\u003e的 \u003ccode\u003e.md\u003c/code\u003e 文件。\u003c/li\u003e\n\u003cli\u003e解析 Markdown 文件的 Frontmatter（元数据），提取标题和描述。\u003c/li\u003e\n\u003cli\u003e调用 Telegram 的 \u003ccode\u003esendMessage\u003c/code\u003e API，将文章标题、描述和链接格式化后发送到指定频道。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"5-配置-github-actions-工作流\"\u003e5. 配置 GitHub Actions 工作流\u003c/h2\u003e\n\u003cp\u003e最后，修改 \u003ccode\u003e.github/workflows/deploy.yml\u003c/code\u003e 文件，在部署流程中加入通知步骤：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-yaml\"\u003e- name: Check for new content and notify\n  if: success()\n  env:\n    TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}\n    TELEGRAM_TO: \"-1003229698152\" # 你的频道 ID\n    SITE_URL: \"https://linguista.cn\"\n    BASE_PATH: \"/alpacanotes\"\n  run: node scripts/telegram-notify.js\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"6-静态站点部署配置\"\u003e6. 静态站点部署配置\u003c/h2\u003e\n\u003cp\u003e本博客使用 Next.js 构建，并托管在 GitHub Pages 上。为了确保静态资源加载正确（特别是当部署在子路径如 \u003ccode\u003e/alpacanotes\u003c/code\u003e 下时），需要在 \u003ccode\u003enext.config.ts\u003c/code\u003e 中进行特别配置：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003econst isProd = process.env.NODE_ENV === \"production\";\n\nconst nextConfig: NextConfig = {\n  // 启用静态导出模式，生成纯 HTML/CSS/JS 文件\n  output: isProd ? \"export\" : undefined,\n  \n  // 禁用 Next.js 自带的图片优化服务（GitHub Pages 不支持 Node.js 运行时）\n  images: {\n    unoptimized: true,\n  },\n  \n  // 设置子路径，匹配 GitHub Pages 的仓库名\n  basePath: isProd ? \"/alpacanotes\" : \"\",\n  assetPrefix: isProd ? \"/alpacanotes/\" : \"\",\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e此外，部署工作流使用了 \u003ccode\u003epeaceiris/actions-gh-pages\u003c/code\u003e Action，它会将 \u003ccode\u003eout\u003c/code\u003e 目录（Next.js \u003ccode\u003eoutput: 'export'\u003c/code\u003e 的产物）自动发布到 \u003ccode\u003egh-pages\u003c/code\u003e 分支。\u003c/p\u003e\n\u003ch2 id=\"7-配置-telegram-instant-view-即时预览\"\u003e7. 配置 Telegram Instant View (即时预览)\u003c/h2\u003e\n\u003cp\u003e为了让用户在 Telegram 中获得更好的阅读体验（无需跳转浏览器即可秒开文章），我们配置了 Instant View。\u003c/p\u003e\n\u003ch3 id=\"71-创建-instant-view-模板\"\u003e7.1 创建 Instant View 模板\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e登录 \u003ca href=\"https://instantview.telegram.org/my/\"\u003eTelegram Instant View Editor\u003c/a\u003e。\u003c/li\u003e\n\u003cli\u003e输入你的博客文章示例链接（例如 \u003ccode\u003ehttps://linguista.cn/alpacanotes/articles/telegram-integration\u003c/code\u003e）。\u003c/li\u003e\n\u003cli\u003e编写提取规则。本项目使用的规则如下（已保存为 \u003ccode\u003einstant-view-rules.txt\u003c/code\u003e）：\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-yaml\"\u003e~version: \"2.1\"\n\n# 1. Content Body\nbody: //article\n\n# 2. Title\ntitle: //h1\n\n# 3. Subtitle (Articles only)\nsubtitle: //article//header//p[contains(@class, \"text-xl\")]\n\n# 4. Published Date (Articles: Header / Notes: Footer)\npublished_date: //header//div[contains(@class, \"text-sm\")] | //div[contains(@class, \"mt-4\") and contains(@class, \"text-sm\")]\n\n# 5. Cleanup\n# Fix: \u0026#x3C;img\u003e inside \u0026#x3C;p\u003e is not allowed\n@split_parent: //p/img\n@remove: //div[contains(@class, \"mt-16\")]/a[contains(@href, \"/articles\")]/..\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e点击 \u003cstrong\u003eMark as Published\u003c/strong\u003e，你将获得一个 \u003cstrong\u003erhash\u003c/strong\u003e（一串哈希值，例如 \u003ccode\u003ed41d8cd98f00b204e980\u003c/code\u003e）。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"72-配置-github-secrets\"\u003e7.2 配置 GitHub Secrets\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e回到 GitHub 仓库的 \u003cstrong\u003eSettings\u003c/strong\u003e \u003e \u003cstrong\u003eSecrets and variables\u003c/strong\u003e \u003e \u003cstrong\u003eActions\u003c/strong\u003e。\u003c/li\u003e\n\u003cli\u003e新建 Secret \u003ccode\u003eTELEGRAM_IV_RHASH\u003c/code\u003e，填入刚才获得的 hash 值。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"73-脚本支持\"\u003e7.3 脚本支持\u003c/h3\u003e\n\u003cp\u003e我们采用了 Telegram Bot API 新版功能 \u003ccode\u003elink_preview_options\u003c/code\u003e 来完美解决兼容性问题：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e显式指定预览链接\u003c/strong\u003e：我们在 API 调用中明确告诉 Telegram 使用 Instant View 链接 (\u003ccode\u003et.me/iv?...\u003c/code\u003e) 来生成预览卡片。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e保留正文原始链接\u003c/strong\u003e：消息正文中的 \u003ccode\u003e[Read More]\u003c/code\u003e 保持指向博客原始网址。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003e效果\u003c/strong\u003e：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eApp 端\u003c/strong\u003e：用户看到的是带有 Instant View 按钮的卡片，点击即开。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWeb 端\u003c/strong\u003e：预览卡片可能不显示或显示为普通链接，但用户点击正文链接时，会直接跳转博客原站，不会出现无法打开的情况。\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003e本文即为该功能的测试文章。如果你在 Telegram 频道看到了这条推送，说明自动化流程已配置成功！\u003c/em\u003e\u003c/p\u003e"])</script><script>self.__next_f.push([1,"8:[\"$\",\"main\",null,{\"className\":\"min-h-screen pb-20\",\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"$L11\",null,{\"contentHtml\":\"$12\"}],[\"$\",\"article\",null,{\"className\":\"container-custom relative md-theme-amp-outer\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-10\",\"children\":[\"\",[\"$\",\"h1\",null,{\"className\":\"text-3xl md:text-4xl font-bold mb-4 text-center font-serif text-[#3e3832] dark:text-[#f0f6fc]\",\"children\":\"AlpacaNotes博客 集成 Telegram 自动推送实战\"}],\"\",[\"$\",\"div\",null,{\"className\":\"text-sm text-muted\",\"children\":\"2026-01-24\"}]]}],[\"$\",\"div\",null,{\"className\":\"prose md-theme-amp\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}],false,[\"$\",\"div\",null,{\"className\":\"mt-16 pt-8 border-t border-[var(--border-subtle)]\",\"children\":[\"$\",\"$L14\",null,{\"href\":\"/articles\",\"className\":\"text-accent hover:text-foreground transition-colors\",\"children\":\"← Back to Articles\"}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:url\",\"content\":\"https://linguista.cn/alpacanotes/articles/telegram-integration-v3\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image\",\"content\":\"https://linguista.cn/alpacanotes/aztecaalpaca.jpg\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"8\",{\"property\":\"article:published_time\",\"content\":\"2026-01-24\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:author\",\"content\":\"@linguista2025\"}],[\"$\",\"meta\",\"10\",{\"property\":\"article:tag\",\"content\":\"DevOps\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:tag\",\"content\":\"Telegram\"}],[\"$\",\"meta\",\"12\",{\"property\":\"article:tag\",\"content\":\"GitHub Actions\"}],[\"$\",\"meta\",\"13\",{\"property\":\"article:tag\",\"content\":\"Automation\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:title\",\"content\":\"AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:description\",\"content\":\"本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:image\",\"content\":\"https://linguista.cn/alpacanotes/aztecaalpaca.jpg\"}],[\"$\",\"link\",\"18\",{\"rel\":\"icon\",\"href\":\"/alpacanotes/favicon.svg\",\"type\":\"image/svg+xml\"}]]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script></body></html>