3:"$Sreact.fragment"
4:I[6498,["177","static/chunks/app/layout-50006a05f4f38e04.js"],"default"]
5:I[8312,["177","static/chunks/app/layout-50006a05f4f38e04.js"],"ThemeProvider"]
6:I[5244,[],""]
7:I[3866,[],""]
9:I[6213,[],"OutletBoundary"]
b:I[6213,[],"MetadataBoundary"]
d:I[6213,[],"ViewportBoundary"]
f:I[4835,[],""]
1:HL["/alpacanotes/_next/static/css/87ceaea6f9666f43.css","style"]
2:HL["/alpacanotes/_next/static/css/b95c8e191d13d635.css","style"]
0:{"P":null,"b":"RSC-HJVmEmHas6d_Ctpca","p":"/alpacanotes","c":["","articles","telegram-integration-v3"],"i":false,"f":[[["",{"children":["articles",{"children":[["id","telegram-integration-v3","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$3","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/alpacanotes/_next/static/css/87ceaea6f9666f43.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/alpacanotes/_next/static/css/b95c8e191d13d635.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"antialiased min-h-screen","children":[["$","$L4",null,{}],["$","$L5",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"disableTransitionOnChange":true,"children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}]]}]}]]}],{"children":["articles",["$","$3","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","articles","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":[["id","telegram-integration-v3","d"],["$","$3","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","articles","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$3","c",{"children":["$L8",null,["$","$L9",null,{"children":"$La"}]]}],{},null]},null]},null]},null],["$","$3","h",{"children":[null,["$","$3","YfxZ0-TQxsxZw6yBAR9XK",{"children":[["$","$Lb",null,{"children":"$Lc"}],["$","$Ld",null,{"children":"$Le"}],null]}]]}]]],"m":"$undefined","G":["$f","$undefined"],"s":false,"S":true}
10:I[2647,["935","static/chunks/935-c3c4a42486495e3b.js","30","static/chunks/30-cde6a761eaef6c52.js","598","static/chunks/598-8424641e72451bd5.js","406","static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js"],"default"]
11:I[7123,["935","static/chunks/935-c3c4a42486495e3b.js","30","static/chunks/30-cde6a761eaef6c52.js","598","static/chunks/598-8424641e72451bd5.js","406","static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js"],"default"]
14:I[4839,["935","static/chunks/935-c3c4a42486495e3b.js","30","static/chunks/30-cde6a761eaef6c52.js","598","static/chunks/598-8424641e72451bd5.js","406","static/chunks/app/articles/%5Bid%5D/page-b4c9447121244ee6.js"],""]
12:T1a29,<p>为了方便读者及时获取更新，我为 AlpacaNotes 博客增加了 Telegram 频道自动推送功能。每当有新文章发布时，GitHub Actions 会自动触发脚本，将文章标题和链接发送到订阅频道。以下是实现这一功能的简要流程。</p>
<h2 id="1-申请-telegram-bot">1. 申请 Telegram Bot</h2>
<p>首先，你需要拥有一个 Telegram 账号并申请一个机器人：</p>
<ol>
<li>在 Telegram 中搜索 <strong>@BotFather</strong>。</li>
<li>发送指令 <code>/newbot</code> 创建新机器人。</li>
<li>按照提示设置机器人的名称（Name）和用户名（Username）。</li>
<li>创建成功后，BotFather 会给你一个 <strong>HTTP API Token</strong>（类似 <code>123456789:ABCdef...</code>），请妥善保管。</li>
</ol>
<h2 id="2-设置频道并获取-chat-id">2. 设置频道并获取 Chat ID</h2>
<ol>
<li>创建一个新的 Telegram Channel（频道），或者使用现有频道。</li>
<li>将你刚才创建的机器人添加为频道管理员（Administrator），赋予发送消息的权限。</li>
<li>为了获取频道的 <code>Chat ID</code>，你可以先在频道里随便发一条消息，然后转发给 <strong>@getidsbot</strong>（或其他类似 ID 查询机器人），它会返回以 <code>-100</code> 开头的频道 ID（例如 <code>-1003229698152</code>）。</li>
</ol>
<h2 id="3-配置-github-secrets">3. 配置 GitHub Secrets</h2>
<p>为了安全起见，不要将 Token 直接硬编码在代码中。</p>
<ol>
<li>进入博客项目的 GitHub 仓库页面。</li>
<li>点击 <strong>Settings</strong> -> <strong>Secrets and variables</strong> -> <strong>Actions</strong>。</li>
<li>新建 Repository Secret：
<ul>
<li><code>TELEGRAM_TOKEN</code>: 填入 BotFather 给你的 Token。</li>
</ul>
</li>
</ol>
<h2 id="4-编写自动化脚本">4. 编写自动化脚本</h2>
<p>在项目中编写一个 Node.js 脚本（<code>scripts/telegram-notify.js</code>），用于检测变更并发送消息。</p>
<p>主要逻辑如下：</p>
<ol>
<li>使用 <code>git diff</code> 识别本次提交中<strong>新增</strong>的 <code>.md</code> 文件。</li>
<li>解析 Markdown 文件的 Frontmatter（元数据），提取标题和描述。</li>
<li>调用 Telegram 的 <code>sendMessage</code> API，将文章标题、描述和链接格式化后发送到指定频道。</li>
</ol>
<h2 id="5-配置-github-actions-工作流">5. 配置 GitHub Actions 工作流</h2>
<p>最后，修改 <code>.github/workflows/deploy.yml</code> 文件，在部署流程中加入通知步骤：</p>
<pre><code class="language-yaml">- name: Check for new content and notify
  if: success()
  env:
    TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
    TELEGRAM_TO: "-1003229698152" # 你的频道 ID
    SITE_URL: "https://linguista.cn"
    BASE_PATH: "/alpacanotes"
  run: node scripts/telegram-notify.js
</code></pre>
<h2 id="6-静态站点部署配置">6. 静态站点部署配置</h2>
<p>本博客使用 Next.js 构建，并托管在 GitHub Pages 上。为了确保静态资源加载正确（特别是当部署在子路径如 <code>/alpacanotes</code> 下时），需要在 <code>next.config.ts</code> 中进行特别配置：</p>
<pre><code class="language-typescript">const isProd = process.env.NODE_ENV === "production";

const nextConfig: NextConfig = {
  // 启用静态导出模式，生成纯 HTML/CSS/JS 文件
  output: isProd ? "export" : undefined,
  
  // 禁用 Next.js 自带的图片优化服务（GitHub Pages 不支持 Node.js 运行时）
  images: {
    unoptimized: true,
  },
  
  // 设置子路径，匹配 GitHub Pages 的仓库名
  basePath: isProd ? "/alpacanotes" : "",
  assetPrefix: isProd ? "/alpacanotes/" : "",
};
</code></pre>
<p>此外，部署工作流使用了 <code>peaceiris/actions-gh-pages</code> Action，它会将 <code>out</code> 目录（Next.js <code>output: 'export'</code> 的产物）自动发布到 <code>gh-pages</code> 分支。</p>
<h2 id="7-配置-telegram-instant-view-即时预览">7. 配置 Telegram Instant View (即时预览)</h2>
<p>为了让用户在 Telegram 中获得更好的阅读体验（无需跳转浏览器即可秒开文章），我们配置了 Instant View。</p>
<h3 id="71-创建-instant-view-模板">7.1 创建 Instant View 模板</h3>
<ol>
<li>登录 <a href="https://instantview.telegram.org/my/">Telegram Instant View Editor</a>。</li>
<li>输入你的博客文章示例链接（例如 <code>https://linguista.cn/alpacanotes/articles/telegram-integration</code>）。</li>
<li>编写提取规则。本项目使用的规则如下（已保存为 <code>instant-view-rules.txt</code>）：</li>
</ol>
<pre><code class="language-yaml">~version: "2.1"

# 1. Content Body
body: //article

# 2. Title
title: //h1

# 3. Subtitle (Articles only)
subtitle: //article//header//p[contains(@class, "text-xl")]

# 4. Published Date (Articles: Header / Notes: Footer)
published_date: //header//div[contains(@class, "text-sm")] | //div[contains(@class, "mt-4") and contains(@class, "text-sm")]

# 5. Cleanup
# Fix: &#x3C;img> inside &#x3C;p> is not allowed
@split_parent: //p/img
@remove: //div[contains(@class, "mt-16")]/a[contains(@href, "/articles")]/..
</code></pre>
<ol start="4">
<li>点击 <strong>Mark as Published</strong>，你将获得一个 <strong>rhash</strong>（一串哈希值，例如 <code>d41d8cd98f00b204e980</code>）。</li>
</ol>
<h3 id="72-配置-github-secrets">7.2 配置 GitHub Secrets</h3>
<ol>
<li>回到 GitHub 仓库的 <strong>Settings</strong> > <strong>Secrets and variables</strong> > <strong>Actions</strong>。</li>
<li>新建 Secret <code>TELEGRAM_IV_RHASH</code>，填入刚才获得的 hash 值。</li>
</ol>
<h3 id="73-脚本支持-2025-更新">7.3 脚本支持 (2025 更新)</h3>
<p>我们采用了 Telegram Bot API 新版功能 <code>link_preview_options</code> 来完美解决兼容性问题：</p>
<ol>
<li><strong>显式指定预览链接</strong>：我们在 API 调用中明确告诉 Telegram 使用 Instant View 链接 (<code>t.me/iv?...</code>) 来生成预览卡片。</li>
<li><strong>保留正文原始链接</strong>：消息正文中的 <code>[Read More]</code> 保持指向博客原始网址。</li>
</ol>
<p><strong>效果</strong>：</p>
<ul>
<li><strong>App 端</strong>：用户看到的是带有 Instant View 按钮的卡片，点击即开。</li>
<li><strong>Web 端</strong>：预览卡片可能不显示或显示为普通链接，但用户点击正文链接时，会直接跳转博客原站，不会出现无法打开的情况。</li>
</ul>
<hr>
<p><em>本文即为该功能的测试文章。如果你在 Telegram 频道看到了这条推送，说明自动化流程已配置成功！</em></p>13:T1a29,<p>为了方便读者及时获取更新，我为 AlpacaNotes 博客增加了 Telegram 频道自动推送功能。每当有新文章发布时，GitHub Actions 会自动触发脚本，将文章标题和链接发送到订阅频道。以下是实现这一功能的简要流程。</p>
<h2 id="1-申请-telegram-bot">1. 申请 Telegram Bot</h2>
<p>首先，你需要拥有一个 Telegram 账号并申请一个机器人：</p>
<ol>
<li>在 Telegram 中搜索 <strong>@BotFather</strong>。</li>
<li>发送指令 <code>/newbot</code> 创建新机器人。</li>
<li>按照提示设置机器人的名称（Name）和用户名（Username）。</li>
<li>创建成功后，BotFather 会给你一个 <strong>HTTP API Token</strong>（类似 <code>123456789:ABCdef...</code>），请妥善保管。</li>
</ol>
<h2 id="2-设置频道并获取-chat-id">2. 设置频道并获取 Chat ID</h2>
<ol>
<li>创建一个新的 Telegram Channel（频道），或者使用现有频道。</li>
<li>将你刚才创建的机器人添加为频道管理员（Administrator），赋予发送消息的权限。</li>
<li>为了获取频道的 <code>Chat ID</code>，你可以先在频道里随便发一条消息，然后转发给 <strong>@getidsbot</strong>（或其他类似 ID 查询机器人），它会返回以 <code>-100</code> 开头的频道 ID（例如 <code>-1003229698152</code>）。</li>
</ol>
<h2 id="3-配置-github-secrets">3. 配置 GitHub Secrets</h2>
<p>为了安全起见，不要将 Token 直接硬编码在代码中。</p>
<ol>
<li>进入博客项目的 GitHub 仓库页面。</li>
<li>点击 <strong>Settings</strong> -> <strong>Secrets and variables</strong> -> <strong>Actions</strong>。</li>
<li>新建 Repository Secret：
<ul>
<li><code>TELEGRAM_TOKEN</code>: 填入 BotFather 给你的 Token。</li>
</ul>
</li>
</ol>
<h2 id="4-编写自动化脚本">4. 编写自动化脚本</h2>
<p>在项目中编写一个 Node.js 脚本（<code>scripts/telegram-notify.js</code>），用于检测变更并发送消息。</p>
<p>主要逻辑如下：</p>
<ol>
<li>使用 <code>git diff</code> 识别本次提交中<strong>新增</strong>的 <code>.md</code> 文件。</li>
<li>解析 Markdown 文件的 Frontmatter（元数据），提取标题和描述。</li>
<li>调用 Telegram 的 <code>sendMessage</code> API，将文章标题、描述和链接格式化后发送到指定频道。</li>
</ol>
<h2 id="5-配置-github-actions-工作流">5. 配置 GitHub Actions 工作流</h2>
<p>最后，修改 <code>.github/workflows/deploy.yml</code> 文件，在部署流程中加入通知步骤：</p>
<pre><code class="language-yaml">- name: Check for new content and notify
  if: success()
  env:
    TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
    TELEGRAM_TO: "-1003229698152" # 你的频道 ID
    SITE_URL: "https://linguista.cn"
    BASE_PATH: "/alpacanotes"
  run: node scripts/telegram-notify.js
</code></pre>
<h2 id="6-静态站点部署配置">6. 静态站点部署配置</h2>
<p>本博客使用 Next.js 构建，并托管在 GitHub Pages 上。为了确保静态资源加载正确（特别是当部署在子路径如 <code>/alpacanotes</code> 下时），需要在 <code>next.config.ts</code> 中进行特别配置：</p>
<pre><code class="language-typescript">const isProd = process.env.NODE_ENV === "production";

const nextConfig: NextConfig = {
  // 启用静态导出模式，生成纯 HTML/CSS/JS 文件
  output: isProd ? "export" : undefined,
  
  // 禁用 Next.js 自带的图片优化服务（GitHub Pages 不支持 Node.js 运行时）
  images: {
    unoptimized: true,
  },
  
  // 设置子路径，匹配 GitHub Pages 的仓库名
  basePath: isProd ? "/alpacanotes" : "",
  assetPrefix: isProd ? "/alpacanotes/" : "",
};
</code></pre>
<p>此外，部署工作流使用了 <code>peaceiris/actions-gh-pages</code> Action，它会将 <code>out</code> 目录（Next.js <code>output: 'export'</code> 的产物）自动发布到 <code>gh-pages</code> 分支。</p>
<h2 id="7-配置-telegram-instant-view-即时预览">7. 配置 Telegram Instant View (即时预览)</h2>
<p>为了让用户在 Telegram 中获得更好的阅读体验（无需跳转浏览器即可秒开文章），我们配置了 Instant View。</p>
<h3 id="71-创建-instant-view-模板">7.1 创建 Instant View 模板</h3>
<ol>
<li>登录 <a href="https://instantview.telegram.org/my/">Telegram Instant View Editor</a>。</li>
<li>输入你的博客文章示例链接（例如 <code>https://linguista.cn/alpacanotes/articles/telegram-integration</code>）。</li>
<li>编写提取规则。本项目使用的规则如下（已保存为 <code>instant-view-rules.txt</code>）：</li>
</ol>
<pre><code class="language-yaml">~version: "2.1"

# 1. Content Body
body: //article

# 2. Title
title: //h1

# 3. Subtitle (Articles only)
subtitle: //article//header//p[contains(@class, "text-xl")]

# 4. Published Date (Articles: Header / Notes: Footer)
published_date: //header//div[contains(@class, "text-sm")] | //div[contains(@class, "mt-4") and contains(@class, "text-sm")]

# 5. Cleanup
# Fix: &#x3C;img> inside &#x3C;p> is not allowed
@split_parent: //p/img
@remove: //div[contains(@class, "mt-16")]/a[contains(@href, "/articles")]/..
</code></pre>
<ol start="4">
<li>点击 <strong>Mark as Published</strong>，你将获得一个 <strong>rhash</strong>（一串哈希值，例如 <code>d41d8cd98f00b204e980</code>）。</li>
</ol>
<h3 id="72-配置-github-secrets">7.2 配置 GitHub Secrets</h3>
<ol>
<li>回到 GitHub 仓库的 <strong>Settings</strong> > <strong>Secrets and variables</strong> > <strong>Actions</strong>。</li>
<li>新建 Secret <code>TELEGRAM_IV_RHASH</code>，填入刚才获得的 hash 值。</li>
</ol>
<h3 id="73-脚本支持-2025-更新">7.3 脚本支持 (2025 更新)</h3>
<p>我们采用了 Telegram Bot API 新版功能 <code>link_preview_options</code> 来完美解决兼容性问题：</p>
<ol>
<li><strong>显式指定预览链接</strong>：我们在 API 调用中明确告诉 Telegram 使用 Instant View 链接 (<code>t.me/iv?...</code>) 来生成预览卡片。</li>
<li><strong>保留正文原始链接</strong>：消息正文中的 <code>[Read More]</code> 保持指向博客原始网址。</li>
</ol>
<p><strong>效果</strong>：</p>
<ul>
<li><strong>App 端</strong>：用户看到的是带有 Instant View 按钮的卡片，点击即开。</li>
<li><strong>Web 端</strong>：预览卡片可能不显示或显示为普通链接，但用户点击正文链接时，会直接跳转博客原站，不会出现无法打开的情况。</li>
</ul>
<hr>
<p><em>本文即为该功能的测试文章。如果你在 Telegram 频道看到了这条推送，说明自动化流程已配置成功！</em></p>8:["$","main",null,{"className":"min-h-screen pb-20","children":[["$","$L10",null,{}],["$","$L11",null,{"contentHtml":"$12"}],["$","article",null,{"className":"container-custom relative md-theme-amp-outer","children":[["$","header",null,{"className":"mb-10","children":[["$","h1",null,{"className":"text-3xl md:text-4xl font-bold mb-4 text-center font-serif text-[#3e3832] dark:text-[#f0f6fc]","children":"AlpacaNotes博客 集成 Telegram 自动推送实战"}],"",["$","div",null,{"className":"text-sm text-muted","children":"2026-01-24"}]]}],["$","div",null,{"className":"prose md-theme-amp","dangerouslySetInnerHTML":{"__html":"$13"}}],false,["$","div",null,{"className":"mt-16 pt-8 border-t border-[var(--border-subtle)]","children":["$","$L14",null,{"href":"/articles","className":"text-accent hover:text-foreground transition-colors","children":"← Back to Articles"}]}]]}]]}]
e:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
c:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes"}],["$","meta","2",{"name":"description","content":"本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。"}],["$","meta","3",{"property":"og:title","content":"AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes"}],["$","meta","4",{"property":"og:description","content":"本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。"}],["$","meta","5",{"property":"og:url","content":"https://linguista.cn/alpacanotes/articles/telegram-integration-v3"}],["$","meta","6",{"property":"og:image","content":"https://linguista.cn/alpacanotes/aztecaalpaca.jpg"}],["$","meta","7",{"property":"og:type","content":"article"}],["$","meta","8",{"property":"article:published_time","content":"2026-01-24"}],["$","meta","9",{"property":"article:author","content":"@linguista2025"}],["$","meta","10",{"property":"article:tag","content":"DevOps"}],["$","meta","11",{"property":"article:tag","content":"Telegram"}],["$","meta","12",{"property":"article:tag","content":"GitHub Actions"}],["$","meta","13",{"property":"article:tag","content":"Automation"}],["$","meta","14",{"name":"twitter:card","content":"summary"}],["$","meta","15",{"name":"twitter:title","content":"AlpacaNotes博客 集成 Telegram 自动推送实战 - AlpacaNotes"}],["$","meta","16",{"name":"twitter:description","content":"本文记录了如何通过 GitHub Actions 和 Telegram Bot API，实现博客新文章自动推送到 Telegram 频道的完整流程。"}],["$","meta","17",{"name":"twitter:image","content":"https://linguista.cn/alpacanotes/aztecaalpaca.jpg"}],["$","link","18",{"rel":"icon","href":"/alpacanotes/favicon.svg","type":"image/svg+xml"}]]
a:null
