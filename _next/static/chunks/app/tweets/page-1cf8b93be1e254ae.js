(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[241],{9350:(e,t,r)=>{Promise.resolve().then(r.bind(r,2647)),Promise.resolve().then(r.bind(r,7546))},2647:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var s=r(5155),a=r(7396),l=r(2115),n=r(767),o=r(6710),c=r(7113);function i(){let{theme:e,setTheme:t}=(0,c.D)(),[r,a]=l.useState(!1);return(l.useEffect(()=>{a(!0)},[]),r)?(0,s.jsxs)("button",{onClick:()=>t("dark"===e?"light":"dark"),className:"p-2 transition-transform hover:scale-110 active:scale-95","aria-label":"Toggle theme",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded-full border border-[var(--accent)] transition-transform duration-500 ".concat("dark"===e?"rotate-180":"rotate-0"),style:{background:"linear-gradient(90deg, var(--accent) 50%, #ffffff 50%)"}}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle theme"})]}):(0,s.jsxs)("button",{className:"p-2 transition-opacity hover:opacity-80","aria-label":"Toggle theme",children:[(0,s.jsx)("div",{className:"w-6 h-6 rounded-full border border-[var(--accent)]",style:{background:"linear-gradient(90deg, var(--accent) 50%, #ffffff 50%)"}}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}function d(e){let{className:t="max-w-6xl mx-auto px-6"}=e,[r,c]=(0,l.useState)(!1);return(0,l.useEffect)(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]),(0,s.jsxs)("header",{className:"py-8 mb-12",children:[(0,s.jsxs)("div",{className:"".concat(t," flex justify-between items-center relative z-50"),children:[(0,s.jsx)(a.default,{href:"/",className:"text-accent font-extrabold text-2xl tracking-tight hover:opacity-80 transition-opacity",onClick:()=>c(!1),children:"AlpacaNotes"}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-8 text-base font-semibold text-muted",children:[(0,s.jsx)(a.default,{href:"/articles",className:"hover:text-foreground transition-colors",children:"Articles"}),(0,s.jsx)(a.default,{href:"/notes",className:"hover:text-foreground transition-colors",children:"Notes"}),(0,s.jsx)(a.default,{href:"/tweets",className:"hover:text-foreground transition-colors",children:"Tweets"}),(0,s.jsx)(a.default,{href:"/topics",className:"hover:text-foreground transition-colors",children:"Topics"}),(0,s.jsx)(a.default,{href:"/prompts",className:"hover:text-foreground transition-colors",children:"Prompts"}),(0,s.jsx)(a.default,{href:"/rss.xml",prefetch:!1,className:"hover:text-foreground transition-colors",children:"RSS"}),(0,s.jsx)("div",{className:"pl-6 border-l border-border-subtle flex items-center",children:(0,s.jsx)(i,{})})]}),(0,s.jsxs)("div",{className:"md:hidden flex items-center gap-4",children:[(0,s.jsx)(i,{}),(0,s.jsx)("button",{className:"text-muted hover:text-foreground transition-colors p-2 -mr-2",onClick:()=>c(!r),"aria-label":"Toggle menu",children:r?(0,s.jsx)(n.A,{size:24}):(0,s.jsx)(o.A,{size:24})})]})]}),r&&(0,s.jsx)("div",{className:"fixed inset-0 bg-background z-40 md:hidden pt-32 px-6 animate-in fade-in duration-200",children:(0,s.jsxs)("nav",{className:"flex flex-col gap-6 text-xl font-medium text-muted",children:[(0,s.jsx)(a.default,{href:"/articles",className:"hover:text-foreground transition-colors py-2",onClick:()=>c(!1),children:"Articles"}),(0,s.jsx)(a.default,{href:"/notes",className:"hover:text-foreground transition-colors py-2",onClick:()=>c(!1),children:"Notes"}),(0,s.jsx)(a.default,{href:"/tweets",className:"hover:text-foreground transition-colors py-2",onClick:()=>c(!1),children:"Tweets"}),(0,s.jsx)(a.default,{href:"/topics",className:"hover:text-foreground transition-colors py-2",onClick:()=>c(!1),children:"Topics"}),(0,s.jsx)(a.default,{href:"/prompts",className:"hover:text-foreground transition-colors py-2",onClick:()=>c(!1),children:"Prompts"}),(0,s.jsx)(a.default,{href:"/rss.xml",prefetch:!1,className:"hover:text-foreground transition-colors py-2",onClick:()=>c(!1),children:"RSS"}),(0,s.jsxs)("div",{className:"pt-8 mt-4 border-t border-border-subtle",children:[(0,s.jsx)("p",{className:"mb-4 text-base text-muted",children:"Subscribe"}),(0,s.jsxs)("div",{className:"flex w-full",children:[(0,s.jsx)("input",{type:"email",placeholder:"Email",className:"bg-surface-soft border border-border-subtle rounded-l px-4 py-3 w-full focus:outline-none focus:border-accent focus:ring-1 focus:ring-accent text-sm"}),(0,s.jsx)("button",{className:"bg-accent text-white px-6 py-3 rounded-r font-bold hover:opacity-90 text-sm whitespace-nowrap",children:"Subscribe"})]})]})]})})]})}},7546:(e,t,r)=>{"use strict";r.d(t,{default:()=>j});var s=r(5155),a=r(2115),l=r(76),n=r(7280),o=r(9191),c=r(9271),i=r(590),d=r(591),u=r(3950),m=r(5765),h=r(767);function x(e){let{tweet:t}=e,[r,x]=(0,a.useState)(!1),[p,f]=(0,a.useState)(""),b=e=>{f(e),x(!0),document.body.style.overflow="hidden"},v=()=>{x(!1),document.body.style.overflow="auto"},g=e=>e?e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString():"0",j="https://twitter.com/".concat(t.author.username,"/status/").concat(t.id);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{id:"tweet-".concat(t.id),className:"flex gap-4 p-6 border-b border-border-subtle hover:bg-surface-soft transition-colors",children:[(0,s.jsx)("div",{className:"flex-shrink-0 pt-1",children:(0,s.jsx)("img",{src:t.author.profile_image_url,alt:t.author.name,className:"w-10 h-10 rounded-full"})}),(0,s.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,s.jsx)("div",{className:"flex items-center justify-between gap-2 mb-1",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold text-foreground truncate",children:t.author.name}),t.author.verified&&(0,s.jsx)("span",{className:"text-accent text-xs",children:"✓"}),(0,s.jsxs)("span",{className:"text-muted truncate",children:["@",t.author.username]}),(0,s.jsx)("span",{className:"text-muted",children:"\xb7"}),(0,s.jsx)("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"text-muted hover:text-foreground hover:underline whitespace-nowrap",suppressHydrationWarning:!0,children:(e=>{let t=new Date(e),r=new Date;return r.getTime()-t.getTime()<864e5?(0,l.m)(t,{addSuffix:!0}).replace("about ",""):t.getFullYear()!==r.getFullYear()?(0,n.GP)(t,"MMM d, yyyy"):(0,n.GP)(t,"MMM d")})(t.created_at)})]})}),(0,s.jsx)("div",{className:"text-[15px] leading-relaxed text-foreground whitespace-pre-wrap break-words",dangerouslySetInnerHTML:(()=>{var e;let r=t.text,s=(null===(e=t.entities)||void 0===e?void 0:e.urls)||[];return s.length>0&&s.forEach(e=>{if(!e.url)return;let t=RegExp(e.url.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g");r=r.replace(t,"")}),t.media&&t.media.length>0&&(r=r.replace(/\s*https:\/\/t\.co\/[a-zA-Z0-9]+$/,"")),{__html:r=(r=(r=(r=r.replace(/(https?:\/\/[^\s]+)/g,'<a href="$1" target="_blank" class="text-accent hover:underline">$1</a>')).replace(/(@\w+)/g,'<span class="text-accent">$1</span>')).replace(/^[\s\u3000]+/,"")).replace(/\n/g,"<br>")}})()}),(()=>{let e;if(!t.media||0===t.media.length)return null;if(1===t.media.length){let r=t.media[0];"photo"===r.type?e=(0,s.jsx)("img",{src:r.url,alt:"Tweet media",className:"w-full h-auto object-cover max-h-[500px] cursor-zoom-in rounded-xl border border-border-subtle",onClick:()=>b(r.url||"")}):("video"===r.type||"animated_gif"===r.type)&&(e=(0,s.jsxs)("div",{className:"relative cursor-pointer rounded-xl overflow-hidden border border-border-subtle",onClick:()=>b(r.preview_image_url||""),children:[(0,s.jsx)("img",{src:r.preview_image_url,className:"w-full h-auto object-cover",alt:"Video preview"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/40 transition-colors",children:(0,s.jsx)("div",{className:"w-12 h-12 bg-accent rounded-full flex items-center justify-center text-white",children:(0,s.jsx)(o.A,{size:20,fill:"currentColor"})})})]}))}else e=(0,s.jsx)("div",{className:"grid grid-cols-2 gap-0.5 rounded-xl overflow-hidden border border-border-subtle",children:t.media.map((e,t)=>{let r=e.url||e.preview_image_url||"";return(0,s.jsx)("div",{className:"relative aspect-square overflow-hidden bg-black cursor-zoom-in",onClick:()=>b(r),children:(0,s.jsx)("img",{src:r,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",alt:"Media ".concat(t+1)})},t)})});return(0,s.jsx)("div",{className:"mt-3",children:e})})(),(()=>{var e;let r=(null===(e=t.entities)||void 0===e?void 0:e.urls)||[];return 0===r.length?null:(0,s.jsx)("div",{className:"mt-3 space-y-3",children:r.map((e,t)=>{let r=e.expanded_url||e.url;if(!r)return null;let a=r.match(/https?:\/\/(?:twitter\.com|x\.com)\/([^/]+)\/status\/(\d+)/),l=e.display_url||r.replace(/^https?:\/\//,""),n="";try{n=new URL(r).hostname.replace(/^www\./,"")}catch(e){n=l.split("/")[0]}if(!a)return(0,s.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"block no-underline group",children:(0,s.jsx)("div",{className:"border border-border-subtle rounded-xl overflow-hidden hover:bg-surface-soft transition-colors",children:(0,s.jsxs)("div",{className:"px-4 py-3",children:[(0,s.jsx)("div",{className:"text-xs text-muted mb-1",children:n}),(0,s.jsx)("div",{className:"text-sm text-foreground truncate",children:l})]})})},t);{let e=a[1];return(0,s.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"block no-underline group",children:(0,s.jsx)("div",{className:"border border-border-subtle rounded-xl overflow-hidden hover:bg-surface-soft transition-colors",children:(0,s.jsxs)("div",{className:"px-4 py-3",children:[(0,s.jsxs)("div",{className:"text-xs text-muted mb-1",children:["引用推文 \xb7 ",n]}),(0,s.jsxs)("div",{className:"text-sm text-foreground truncate",children:["引用 @",e," 的推文"]})]})})},t)}})})})(),(0,s.jsxs)("div",{className:"flex justify-between mt-4 max-w-md text-muted text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 group cursor-pointer hover:text-accent",children:[(0,s.jsx)("div",{className:"p-2 -m-2 rounded-full group-hover:bg-accent/10 transition-colors",children:(0,s.jsx)(c.A,{size:16})}),(0,s.jsx)("span",{children:g(t.metrics.reply_count)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 group cursor-pointer hover:text-green-500",children:[(0,s.jsx)("div",{className:"p-2 -m-2 rounded-full group-hover:bg-green-500/10 transition-colors",children:(0,s.jsx)(i.A,{size:16})}),(0,s.jsx)("span",{children:g(t.metrics.retweet_count)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 group cursor-pointer hover:text-pink-500",children:[(0,s.jsx)("div",{className:"p-2 -m-2 rounded-full group-hover:bg-pink-500/10 transition-colors",children:(0,s.jsx)(d.A,{size:16})}),(0,s.jsx)("span",{children:g(t.metrics.like_count)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 group cursor-pointer hover:text-accent",children:[(0,s.jsx)("div",{className:"p-2 -m-2 rounded-full group-hover:bg-accent/10 transition-colors",children:(0,s.jsx)(u.A,{size:16})}),(0,s.jsx)("span",{children:g(t.metrics.view_count||t.metrics.impression_count||0)})]}),(0,s.jsx)("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 group cursor-pointer hover:text-accent",children:(0,s.jsx)("div",{className:"p-2 -m-2 rounded-full group-hover:bg-accent/10 transition-colors",children:(0,s.jsx)(m.A,{size:16})})})]})]})]}),r&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4",onClick:v,children:[(0,s.jsx)("button",{onClick:v,className:"absolute top-4 right-4 text-white/70 hover:text-white p-2",children:(0,s.jsx)(h.A,{size:32})}),(0,s.jsx)("img",{src:p,alt:"Full size",className:"max-w-full max-h-[90vh] object-contain",onClick:e=>e.stopPropagation()})]})]})}var p=r(113),f=r(4984);function b(e){let{counts:t,pages:r,onSelectDate:l,className:o=""}=e,[c,i]=(0,a.useState)("按日期查看"),d=(0,a.useRef)(null),u=(0,a.useMemo)(()=>{let e=Object.keys(t).sort();if(0===e.length)return[];let s=(0,p.H)(e[0]),a=(0,p.H)(e[e.length-1]),l=new Date(s);l.setDate(l.getDate()-l.getDay());let o=new Date(a);o.setDate(o.getDate()+(6-o.getDay()));let c=[],i=l;for(;i<=o;){var d;let e=(d=i,(0,n.GP)(d,"yyyy-MM-dd")),s=Number(t[e]||0),a=r[e]?Number(r[e]):null;c.push({date:e,count:s,page:a,level:s<=0?0:s<=3?1:s<=9?2:s<=19?3:4}),i=(0,f.f)(i,1)}return c},[t,r]);if(0===u.length)return null;let m=()=>{let e=d.current;if(!e)return;let t=Array.from(e.children);if(!t.length)return;let r=e.scrollLeft+e.clientWidth,s=t[0];for(let e of t)if(e.offsetLeft+e.offsetWidth<=r+1)s=e;else break;let a=s.dataset.date;a&&i(a.slice(0,4))};return(0,s.jsxs)("details",{className:"anthyle-heatmap-shell ".concat(o),open:!0,children:[(0,s.jsxs)("summary",{className:"anthyle-heatmap-summary",children:[(0,s.jsx)("span",{className:"anthyle-heatmap-summary-title",children:"热图导航"}),(0,s.jsx)("span",{className:"anthyle-heatmap-summary-meta",children:c})]}),(0,s.jsx)("div",{className:"anthyle-heatmap-body",children:(0,s.jsxs)("div",{className:"anthyle-heatmap","data-heatmap-root":!0,children:[(0,s.jsx)("div",{className:"anthyle-heatmap-grid",ref:e=>{e&&(d.current=e,requestAnimationFrame(()=>{e.scrollLeft=e.scrollWidth,m()}))},onScroll:m,children:u.map(e=>{let t="".concat((0,n.GP)((0,p.H)(e.date),"yyyy-MM-dd")," (").concat(e.count,")");return e.count>0&&e.page?(0,s.jsx)("button",{type:"button","data-date":e.date,title:t,"aria-label":t,className:"anthyle-heatmap-cell level-".concat(e.level),onClick:()=>null==l?void 0:l(e.date)},e.date):(0,s.jsx)("span",{"data-date":e.date,title:t,"aria-hidden":"true",className:"anthyle-heatmap-cell level-0 is-empty"},e.date)})}),(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-[var(--text-muted)]",children:[(0,s.jsx)("span",{children:"Less"}),(0,s.jsx)("span",{className:"anthyle-heatmap-swatch level-0"}),(0,s.jsx)("span",{className:"anthyle-heatmap-swatch level-1"}),(0,s.jsx)("span",{className:"anthyle-heatmap-swatch level-2"}),(0,s.jsx)("span",{className:"anthyle-heatmap-swatch level-3"}),(0,s.jsx)("span",{className:"anthyle-heatmap-swatch level-4"}),(0,s.jsx)("span",{children:"More"})]})]})})]})}let v=()=>{var e,t;let r=window.location.pathname.match(/^(.*)\/tweets(?:\/|$)/);if(r){let e=r[1];return e&&"/"!==e?e:""}let s=null!==(t=null===(e=window.__NEXT_DATA__)||void 0===e?void 0:e.assetPrefix)&&void 0!==t?t:"";return s?s.endsWith("/")?s.slice(0,-1):s:""},g=async e=>{let t=v(),r="".concat(t).concat(e),s=await fetch(r,{cache:"no-store"});if(!s.ok&&t){let t=await fetch(e,{cache:"no-store"});if(t.ok)return t.json()}if(!s.ok)throw Error("Failed to load ".concat(e,": ").concat(s.status));return s.json()};function j(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(null),[n,o]=(0,a.useState)(null),[c,i]=(0,a.useState)(!0),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[p,f]=(0,a.useState)(1),v=(0,a.useCallback)(async e=>{t(await g("/tweets/pages/".concat(e-1,".json")))},[]);(0,a.useEffect)(()=>{let e=!0;return(async()=>{i(!0),h(null);try{let[t,r]=await Promise.all([g("/tweets/manifest.json"),g("/tweets/heatmap.json")]);if(!e)return;l(t),o(r),f(1),await v(1)}catch(t){if(!e)return;h("无法加载推文数据，请确认已生成并部署 public/tweets 下的 manifest/pages/heatmap 文件。"),console.error("Failed to initialize tweets page:",t)}finally{e&&i(!1)}})(),()=>{e=!1}},[v]);let j=(0,a.useCallback)(async e=>{if(!r)return;let t=Math.min(Math.max(e,1),r.totalPages);if(t!==p){u(!0),h(null);try{await v(t),f(t),window.scrollTo({top:0,behavior:"smooth"})}catch(e){h("推文分页加载失败，请稍后重试。"),console.error("Failed to load tweets page:",e)}finally{u(!1)}}},[r,p,v]),N=(0,a.useCallback)(e=>{if(!n)return;let t=n.pages[e];t&&j(t)},[n,j]),y=(0,a.useMemo)(()=>{if(!r)return[];let e=r.totalPages,t=[],s=0;for(let r=1;r<=e;r+=1)(1===r||r===e||r>=p-2&&r<=p+2)&&(s>0&&r-s>1&&t.push("ellipsis"),t.push(r),s=r);return t},[r,p]),w=p>1,k=!!r&&p<r.totalPages;return(0,s.jsxs)("div",{className:"space-y-6",children:[n&&(0,s.jsx)(b,{counts:n.counts,pages:n.pages,maxCount:n.maxCount,onSelectDate:N}),(0,s.jsx)("div",{className:"rounded-xl border border-[var(--border-subtle)] bg-[var(--surface)] overflow-hidden",children:c?(0,s.jsx)("div",{className:"p-12 text-center text-[var(--text-muted)]",children:"正在加载推文..."}):(0,s.jsxs)(s.Fragment,{children:[e.map(e=>(0,s.jsx)(x,{tweet:e},e.id)),m&&(0,s.jsx)("div",{className:"p-6 text-center text-sm text-red-500",children:m}),!m&&0===e.length&&(0,s.jsx)("div",{className:"p-12 text-center text-[var(--text-muted)]",children:"No tweets found. Please check the data directory."}),d&&(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("div",{className:"inline-block h-6 w-6 animate-spin rounded-full border-2 border-[var(--border-subtle)] border-t-[var(--accent)]"})})]})}),r&&r.totalPages>1&&(0,s.jsxs)("nav",{className:"flex flex-wrap items-center justify-center gap-2 text-sm","aria-label":"Tweets pagination",children:[(0,s.jsx)("button",{type:"button",onClick:()=>void j(p-1),disabled:!w||d,className:"rounded-lg border border-[var(--border-subtle)] bg-[var(--surface)] px-3 py-1 disabled:opacity-50",children:"上一页"}),y.map((e,t)=>"ellipsis"===e?(0,s.jsx)("span",{className:"px-2 text-[var(--text-muted)]",children:"..."},"ellipsis-".concat(t)):(0,s.jsx)("button",{type:"button",onClick:()=>void j(e),disabled:e===p||d,className:"rounded-lg border px-3 py-1 ".concat(e===p?"border-[var(--accent)] bg-[var(--surface-soft)] font-semibold":"border-[var(--border-subtle)] bg-[var(--surface)]"," disabled:opacity-60"),children:e},e)),(0,s.jsx)("button",{type:"button",onClick:()=>void j(p+1),disabled:!k||d,className:"rounded-lg border border-[var(--border-subtle)] bg-[var(--surface)] px-3 py-1 disabled:opacity-50",children:"下一页"})]}),r&&(0,s.jsxs)("p",{className:"text-center text-xs text-[var(--text-muted)]",children:["第 ",p," / ",r.totalPages," 页 \xb7 每页 ",r.pageSize," 条 \xb7 共 ",r.totalTweets," 条"]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[935,629,441,517,358],()=>t(9350)),_N_E=e.O()}]);