3:"$Sreact.fragment"
4:I[6498,["177","static/chunks/app/layout-50006a05f4f38e04.js"],"default"]
5:I[8312,["177","static/chunks/app/layout-50006a05f4f38e04.js"],"ThemeProvider"]
6:I[5244,[],""]
7:I[3866,[],""]
9:I[6213,[],"OutletBoundary"]
b:I[6213,[],"MetadataBoundary"]
d:I[6213,[],"ViewportBoundary"]
f:I[4835,[],""]
1:HL["/alpacanotes/_next/static/css/87ceaea6f9666f43.css","style"]
2:HL["/alpacanotes/_next/static/css/b147b4b724ae21ef.css","style"]
0:{"P":null,"b":"8dt48eNjZAF8aaCAw3zKz","p":"/alpacanotes","c":["","notes","telegram-push-summary-v1"],"i":false,"f":[[["",{"children":["notes",{"children":[["id","telegram-push-summary-v1","c"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$3","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/alpacanotes/_next/static/css/87ceaea6f9666f43.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/alpacanotes/_next/static/css/b147b4b724ae21ef.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"antialiased min-h-screen","children":[["$","$L4",null,{}],["$","$L5",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"disableTransitionOnChange":true,"children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}]]}]}]]}],{"children":["notes",["$","$3","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","notes","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":[["id","telegram-push-summary-v1","c"],["$","$3","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","notes","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L7",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$3","c",{"children":["$L8",null,["$","$L9",null,{"children":"$La"}]]}],{},null]},null]},null]},null],["$","$3","h",{"children":[null,["$","$3","J9sH-8Gszog64G0eYssFZ",{"children":[["$","$Lb",null,{"children":"$Lc"}],["$","$Ld",null,{"children":"$Le"}],null]}]]}]]],"m":"$undefined","G":["$f","$undefined"],"s":false,"S":true}
10:I[2647,["935","static/chunks/935-c3c4a42486495e3b.js","568","static/chunks/app/notes/page-bd09ebd6d0bf9f87.js"],"default"]
11:I[4839,["935","static/chunks/935-c3c4a42486495e3b.js","568","static/chunks/app/notes/page-bd09ebd6d0bf9f87.js"],""]
12:Td8f,<p>终于把博客自动同步到 Telegram 频道的功能彻底搞定了。</p>
<p>回顾一下这次折腾的过程，其实核心逻辑不难，细节全是坑：</p>
<h3 id="1-基础链路bot--actions">1. 基础链路：Bot + Actions</h3>
<ul>
<li><strong>申请机器人</strong>：找 BotFather 申请机器人，拉进频道当管理员，拿 Token 和 Chat ID。这步最简单。</li>
<li><strong>自动化脚本</strong>：写了个 Node.js 脚本，配合 GitHub Actions。每次代码 push 到 main 分支时，用 <code>git diff</code> 算出新增的 Markdown 文件，解析出标题和链接发给 Bot。</li>
</ul>
<h3 id="2-问题一文件重命名检测失效">2. 问题一：文件重命名检测失效</h3>
<ul>
<li><strong>现象</strong>：修改了文件名（如 <code>v1.md</code> -> <code>v2.md</code>）后，推送没有触发通知。</li>
<li><strong>原因</strong>：Git 将此操作识别为 <strong>重命名 (Rename)</strong>，而脚本最初只检测 <strong>新增 (Add)</strong>。</li>
<li><strong>解决</strong>：将 <code>git diff</code> 的过滤器从 <code>A</code> 升级为 <code>ACR</code>，同时覆盖 Add、Copy、Rename 三种情况。</li>
</ul>
<h3 id="3-问题二instant-view-规则报错">3. 问题二：Instant View 规则报错</h3>
<ul>
<li><strong>现象</strong>：IV 模板测试时，提示 <code>&#x3C;img> is not supported in &#x3C;p></code>。</li>
<li><strong>原因</strong>：Markdown 渲染器默认将图片包裹在 <code>&#x3C;p></code> 标签里，但 IV 规范不允许。</li>
<li><strong>解决</strong>：在 IV 规则中加入 <code>@split_parent: //p/img</code>，强制将图片与父级段落拆开。</li>
</ul>
<h3 id="4-问题三web-端链接无法打开">4. 问题三：Web 端链接无法打开</h3>
<ul>
<li><strong>现象</strong>：App 端点击 <code>t.me/iv?...</code> 链接能秒开，但 Web 端点击后无反应或报错。</li>
<li><strong>原因</strong>：Telegram Web 对 IV 链接的支持极差。</li>
<li><strong>尝试1（隐形链接）</strong>：在消息开头插入零宽空格 <code>[\u200B](IV链接)</code>，正文保留原始链接。这能在 App 端触发卡片，但依然不够优雅。</li>
<li><strong>尝试2（官方方案）</strong>：升级到 Telegram Bot API 的 <code>link_preview_options</code>。在 API 调用中显式指定 <code>url: "t.me/iv?..."</code> 用于生成预览卡片，而正文链接保持原始网址。这是目前最稳健的方案。</li>
</ul>
<h3 id="5-问题四通知没有预览卡片时序问题">5. 问题四：通知没有预览卡片（时序问题）</h3>
<ul>
<li><strong>现象</strong>：消息能发送，但无论 App 还是 Web 都没有预览卡片。</li>
<li><strong>原因</strong>：通知步骤在部署步骤<strong>之前</strong>执行。当 Telegram 服务器收到链接去抓取时，新文章还未上线，返回 404，导致预览生成失败。</li>
<li><strong>解决</strong>：调整 GitHub Actions 工作流顺序，将通知步骤移到部署<strong>之后</strong>，并增加 10 秒延迟等待 CDN 生效。</li>
</ul>
<h3 id="最终流程">最终流程</h3>
<p>写文章 -> Push -> 自动触发 Action -> <strong>先部署</strong> -> <strong>等待 10s</strong> -> <strong>再通知</strong> -> 频道秒推 (带 Instant View)。</p>
<p>舒服了，继续搬砖。</p>
<p><em>(Update: 优化了通知样式，现在 Note 会自动生成标题、摘要和标签了)</em></p>8:["$","main",null,{"className":"min-h-screen pb-20 bg-background text-foreground","children":[["$","$L10",null,{}],["$","div",null,{"className":"container-custom","children":[["$","$L11",null,{"href":"/","className":"inline-flex items-center text-muted hover:text-accent transition-colors mb-8 font-medium text-sm group","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":16,"height":16,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left mr-2 group-hover:-translate-x-1 transition-transform","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}]," Back to Home"]}],["$","article",null,{"className":"max-w-none","children":[["$","h1",null,{"className":"text-3xl font-bold mb-6","children":"Jan 24, 2026"}],["$","div",null,{"className":"prose prose-lg dark:prose-invert max-w-none prose-headings:font-bold prose-headings:tracking-tight prose-a:text-accent prose-a:no-underline hover:prose-a:underline prose-img:rounded-xl prose-pre:bg-surface-soft prose-pre:border prose-pre:border-border-subtle","dangerouslySetInnerHTML":{"__html":"$12"}}],["$","div",null,{"className":"mt-4 text-sm text-muted flex flex-wrap gap-2 items-center","children":[["$","span",null,{"className":"text-accent","children":"#"}],["$","span",null,{"children":"1:10 pm"}],[["$","span",null,{"children":"/"}],[["$","span","折腾",{"children":["折腾",", "]}],["$","span","Telegram",{"children":["Telegram",", "]}],["$","span","自动化",{"children":["自动化",""]}]]]]}]]}]]}]]}]
e:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
c:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Note from Jan 24, 2026 - AlpacaNotes"}],["$","meta","2",{"name":"description","content":"Note posted on Jan 24, 2026"}],["$","meta","3",{"property":"og:title","content":"Note from Jan 24, 2026 - AlpacaNotes"}],["$","meta","4",{"property":"og:description","content":"Note posted on Jan 24, 2026"}],["$","meta","5",{"property":"og:url","content":"https://linguista.cn/alpacanotes/notes/telegram-push-summary-v1"}],["$","meta","6",{"property":"og:type","content":"article"}],["$","meta","7",{"property":"article:published_time","content":"2026-01-24T13:10:00"}],["$","meta","8",{"property":"article:author","content":"@linguista2025"}],["$","meta","9",{"property":"article:tag","content":"折腾"}],["$","meta","10",{"property":"article:tag","content":"Telegram"}],["$","meta","11",{"property":"article:tag","content":"自动化"}],["$","meta","12",{"name":"twitter:card","content":"summary"}],["$","meta","13",{"name":"twitter:title","content":"Note from Jan 24, 2026 - AlpacaNotes"}],["$","meta","14",{"name":"twitter:description","content":"Note posted on Jan 24, 2026"}],["$","link","15",{"rel":"icon","href":"/alpacanotes/favicon.svg","type":"image/svg+xml"}]]
a:null
